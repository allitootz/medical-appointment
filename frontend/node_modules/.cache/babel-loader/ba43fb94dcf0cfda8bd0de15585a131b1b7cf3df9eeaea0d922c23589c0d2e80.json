{"ast":null,"code":"var _jsxFileName = \"E:\\\\School\\\\School\\\\Integrative Programming\\\\medical-appointment\\\\frontend\\\\src\\\\components\\\\patient\\\\patientinformation\\\\TwoFactorAuth\\\\TwoFactorAuth.jsx\",\n  _s = $RefreshSig$();\nimport axios from 'axios';\nimport React, { useState } from 'react';\nimport { useParams } from 'react-router-dom';\nimport './TwoFactorAuth.css';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport { Modal, Button } from 'react-bootstrap';\nimport { ip } from '../../../../ContentExport';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction TwoFactorAuth() {\n  _s();\n  const {\n    pid\n  } = useParams();\n  const [qrCode, setQrCode] = useState(null);\n  const [secretKey, setSecretKey] = useState(null);\n  const [showModal, setShowModal] = useState(false);\n  const setupTwoFactor = async (userId, regenerate = false) => {\n    try {\n      const response = await axios.post(`${ip.address}/patient/api/setup-2fa/${userId}`, {\n        regenerate\n      });\n      if (response.data.qrCode && response.data.secret) {\n        setQrCode(response.data.qrCode);\n        setSecretKey(response.data.secret);\n      } else {\n        window.alert(\"Error setting up 2FA\");\n      }\n    } catch (error) {\n      console.error('Error setting up 2FA:', error); // Log the error\n      window.alert(\"Error setting up 2FA\");\n    }\n  };\n  const handleRegenerate = () => {\n    setShowModal(true); // Show confirmation modal\n  };\n  const confirmRegenerate = () => {\n    setupTwoFactor(pid, true);\n    setQrCode(null); // Clear the QR code when regenerating\n    setSecretKey(null); // Clear the secret key when regenerating\n    setShowModal(false); // Hide confirmation modal\n  };\n  const cancelRegenerate = () => {\n    setShowModal(false); // Hide confirmation modal\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container mt-5\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"text-center mb-4\",\n      style: {\n        lineHeight: '0.02'\n      },\n      children: \"Register to Two Factor Authentication\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      style: {\n        textAlign: 'center',\n        fontSize: '13px',\n        fontStyle: 'italic'\n      },\n      children: \"Use any authenticator app (Google Authenticator or Microsoft Authenticator) to add a protection layer to your account\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 13\n    }, this), qrCode && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"tfa-container\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"tfa-card\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"tfa-cardqr\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"tfa-cardqr1\",\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              src: qrCode,\n              alt: \"QR Code\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 53,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"tfa-cardqr2\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"Secret Key:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 55,\n                columnNumber: 37\n              }, this), secretKey && /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"tfa-text\",\n                children: secretKey\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 57,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 54,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 52,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 51,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 50,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-center mb-4\",\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn btn-primary\",\n        onClick: handleRegenerate,\n        children: \"Generate New Secret Key\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      show: showModal,\n      onHide: cancelRegenerate,\n      children: [/*#__PURE__*/_jsxDEV(Modal.Header, {\n        closeButton: true,\n        children: /*#__PURE__*/_jsxDEV(Modal.Title, {\n          children: \"Confirm Change\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Modal.Body, {\n        children: \"Are you sure you want to change your secret key?\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Modal.Footer, {\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          variant: \"secondary\",\n          onClick: cancelRegenerate,\n          children: \"No\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"danger\",\n          onClick: confirmRegenerate,\n          children: \"Yes\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 45,\n    columnNumber: 9\n  }, this);\n}\n_s(TwoFactorAuth, \"9Us0wCYngtyI49m9qF7JEjfm6xY=\", false, function () {\n  return [useParams];\n});\n_c = TwoFactorAuth;\nexport default TwoFactorAuth;\nvar _c;\n$RefreshReg$(_c, \"TwoFactorAuth\");","map":{"version":3,"names":["axios","React","useState","useParams","Modal","Button","ip","jsxDEV","_jsxDEV","TwoFactorAuth","_s","pid","qrCode","setQrCode","secretKey","setSecretKey","showModal","setShowModal","setupTwoFactor","userId","regenerate","response","post","address","data","secret","window","alert","error","console","handleRegenerate","confirmRegenerate","cancelRegenerate","className","children","style","lineHeight","fileName","_jsxFileName","lineNumber","columnNumber","textAlign","fontSize","fontStyle","src","alt","onClick","show","onHide","Header","closeButton","Title","Body","Footer","variant","_c","$RefreshReg$"],"sources":["E:/School/School/Integrative Programming/medical-appointment/frontend/src/components/patient/patientinformation/TwoFactorAuth/TwoFactorAuth.jsx"],"sourcesContent":["import axios from 'axios';\r\nimport React, { useState } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport './TwoFactorAuth.css';\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\nimport { Modal, Button } from 'react-bootstrap';\r\nimport { ip } from '../../../../ContentExport';\r\nfunction TwoFactorAuth() {\r\n    const { pid } = useParams();\r\n    const [qrCode, setQrCode] = useState(null);\r\n    const [secretKey, setSecretKey] = useState(null);\r\n    const [showModal, setShowModal] = useState(false);\r\n\r\n    const setupTwoFactor = async (userId, regenerate = false) => {\r\n        try {\r\n            const response = await axios.post(`${ip.address}/patient/api/setup-2fa/${userId}`, { regenerate });\r\n            if (response.data.qrCode && response.data.secret) {\r\n                setQrCode(response.data.qrCode);\r\n                setSecretKey(response.data.secret);\r\n            } else {\r\n                window.alert(\"Error setting up 2FA\");\r\n            }\r\n        } catch (error) {\r\n            console.error('Error setting up 2FA:', error); // Log the error\r\n            window.alert(\"Error setting up 2FA\");\r\n        }\r\n    };\r\n\r\n    const handleRegenerate = () => {\r\n        setShowModal(true); // Show confirmation modal\r\n    };\r\n\r\n    const confirmRegenerate = () => {\r\n        setupTwoFactor(pid, true);\r\n        setQrCode(null); // Clear the QR code when regenerating\r\n        setSecretKey(null); // Clear the secret key when regenerating\r\n        setShowModal(false); // Hide confirmation modal\r\n    };\r\n\r\n    const cancelRegenerate = () => {\r\n        setShowModal(false); // Hide confirmation modal\r\n    };\r\n\r\n    return (\r\n        <div className=\"container mt-5\">\r\n            <h2 className=\"text-center mb-4\" style={{ lineHeight: '0.02' }}>Register to Two Factor Authentication</h2>\r\n            <p style={{ textAlign: 'center', fontSize: '13px', fontStyle: 'italic' }}>Use any authenticator app (Google Authenticator or Microsoft Authenticator) to add a protection layer to your account</p>\r\n            {qrCode && (\r\n                <div className=\"tfa-container\">\r\n                    <div className=\"tfa-card\">\r\n                        <div className=\"tfa-cardqr\">\r\n                            <div className=\"tfa-cardqr1\">\r\n                                <img src={qrCode} alt=\"QR Code\" />\r\n                                <div className=\"tfa-cardqr2\">\r\n                                    <p>Secret Key:</p>\r\n                                    {secretKey && (\r\n                                        <p className=\"tfa-text\">{secretKey}</p>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n            <div className=\"text-center mb-4\">\r\n                <button className=\"btn btn-primary\" onClick={handleRegenerate}>Generate New Secret Key</button>\r\n            </div>\r\n\r\n            {/* Confirmation Modal */}\r\n            <Modal show={showModal} onHide={cancelRegenerate}>\r\n                <Modal.Header closeButton>\r\n                    <Modal.Title>Confirm Change</Modal.Title>\r\n                </Modal.Header>\r\n                <Modal.Body>\r\n                    Are you sure you want to change your secret key?\r\n                </Modal.Body>\r\n                <Modal.Footer>\r\n                    <Button variant=\"secondary\" onClick={cancelRegenerate}>\r\n                        No\r\n                    </Button>\r\n                    <Button variant=\"danger\" onClick={confirmRegenerate}>\r\n                        Yes\r\n                    </Button>\r\n                </Modal.Footer>\r\n            </Modal>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default TwoFactorAuth;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}